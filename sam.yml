TCBSAMFormatVersion: "2020-06-15"
Name: tcb-ext-cms
SpecVersion: v1beta
Version: 2.0.0
License: Apache-2.0
Category: CloudApp
DisplayName: CMS内容管理系统
Description: 方便开发人员和内容运营者，随时随地管理小程序/Web 等多端云开发内容数据，支持文本、富文本、图片、文件、关联类型等多种内容类型的可视化编辑
Tags:
  - 快速使用
  - 典型示例
  - 内容管理
  - 免开发
# 后付费环境才可以开通
EnvType: PostPay
# @todo
SourceUrl: https://github.com/TencentCloudBase/cloudbase-extension-cms
# @todo
ReleaseNotesUrl: https://github.com/TencentCloudBase/cloudbase-extension-cms/releases
# @todo
IconUrl: https://main.qcloudimg.com/raw/f87b49914efe502722f9aa128f5d8865/hello_world.svg
IntroUrl: https://cloud.tencent.com/document/product/876/44547
# 更新日志
ChangeLog:
  - Title: 2.0.0
    Content:
      - 新增用户权限管理功能
Author:
  AuthorName: TCB
  Email: cloudbase@tencent.com
  Url: https://cloud.tencent.com
Contributors:
  - AuthorName: chhpt
    Email: cwuyiqing@gmail.com
    Url: http://github.com/chhpt
  - AuthorName: bookerzhao
    Email: being99@qq.com
    Url: https://github.com/binggg
Resources:
  # API 服务函数
  AuthFunction:
    Type: CloudBase::Function
    Properties:
      FunctionName: tcb-ext-cms-service
      # CodeUri: cloud://appstore.6170-appstore-1259727701/tcb-ext-cms-service.zip
      CodeUri: extension://568fb2ccfff94e918467e34ecc022e94.zip
      InstallDependency: true
      Description: 提供 CMS 管理服务，所有对内容的操作和管理都会经过此函数调用，内容操作会根据用户权限来进行数据库操作
      MemorySize: 256
      Timeout: 10
      HttpPath: /tcb-ext-cms-service
      Runtime: Nodejs10.15
      Handler: index.main
      Role: TCB_QcsRole
  # 初始化函数
  InitFunction:
    Type: CloudBase::Function
    Properties:
      FunctionName: tcb-ext-cms-init
      # CodeUri: cloud://appstore.6170-appstore-1259727701/tcb-ext-cms-init.zip
      CodeUri: extension://6a176c91a72c42fabd41dd63ce9763b2.zip
      InstallDependency: true
      Description: 提供初始化应用功能，安装扩展后，会通过该函数来进行静态资源的部署和密码的生成和设置，修改账号密码或者部署路径等扩展参数都会再次执行该函数来进行更新
      MemorySize: 256
      Timeout: 10
      Runtime: Nodejs10.15
      Handler: index.main
      Environment:
        Variables:
          # CMS_ADMIN_USER_NAME: ""
          # CMS_ADMIN_PASS_WORD: ""
          # CMS_OPERATOR_USER_NAME: ""
          # CMS_OPERATOR_PASS_WORD: ""
          CMS_DEPLOY_PATH: "/tcb-cms"
      Role: TCB_QcsRole
  ProjectDB:
    Type: CloudBase::FlexDB
    Properties:
      CollectionName: tcb-ext-cms-projects
      Description: CMS 系统项目数据（请不要手动修改）
      AclTag: ADMINONLY
  # 系统内容数据集合
  SchemaDB:
    Type: CloudBase::FlexDB
    Properties:
      CollectionName: tcb-ext-cms-schemas
      Description: CMS 系统内容模型数据（请不需要手动修改）
      AclTag: ADMINONLY
  # 系统用户数据集合
  UsersDB:
    Type: CloudBase::FlexDB
    Properties:
      CollectionName: tcb-ext-cms-users
      Description: CMS 系统系统用户数据，存储 CMS 的用户信息，包括管理员账号信息，角色信息等（请不要手动修改）
      AclTag: ADMINONLY
  # 系统 webhook 数据集合
  WebhookDB:
    Type: CloudBase::FlexDB
    Properties:
      CollectionName: tcb-ext-cms-webhooks
      Description: CMS 系统 webhook 集合，存储 CMS 系统的回调接口配置，CMS 系统数据的变更可以通过回调来进行同步 （请不要手动修改）
      AclTag: ADMINONLY
  SettingDB:
    Type: CloudBase::FlexDB
    Properties:
      CollectionName: tcb-ext-cms-settings
      Description: CMS 系统系统配置集合，存储 CMS 系统的设置（请不要手动修改）
      AclTag: ADMINONLY
  RoleDB:
    Type: CloudBase::FlexDB
    Properties:
      CollectionName: tcb-ext-cms-user-roles
      Description: CMS 系统系统用户角色配置集合，存储 CMS 系统的自定义用户角色信息（请不要手动修改）
      AclTag: ADMINONLY
  # 开通静态托管
  StaticStore:
    Type: CloudBase::StaticStore
    Properties:
      Description: CMS 系统前端界面，基于 React 开发，通过 CloudBase JS SDK 访问 CMS 的函数、数据库和存储等资源 （请不要手动修改）
# 配置
Config:
  # 初始化脚本
  InstalledHook:
    - FunctionName: tcb-ext-cms-init
